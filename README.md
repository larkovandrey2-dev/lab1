Лабораторная работа №1: Калькулятор на основе RPN (Уровень M2)

Студент: Ларьков Андрей Александрович, М8О-103БВ-25

----------------

Цели лабораторной работы:
--
1. Изучить алгоритмы перевода инфиксных выражений в обратную польскую нотацию
2. Реализовать вычисление выражения, записанного в RPN
3. Научиться обработке ошибок, валидации входного выражения, оформлению кода и написанию аннотаций.

----------------

Возможности калькулятора:
--
- Арифметические операции: `+`, `-`, `*`, `/`
- Целочисленное деление `//` и остаток `%`
- Возведение в степень `**`
- Унарные `+` и `-`
- Скобки для задания приоритета операций
- Вывод предупреждений для больших значений
- Округление дробных результатов до 2 знаков (по умолчанию, настраивается)

----------------

Особенности реализации и структуры проекта:
--
- tokenizer.py:
  
   - Проверяет корректность исходного выражения и разделяет его на токены с помощью регулярных выражений.
   
   - Поддерживает числа с плавающей точкой, ведущие нули и числа с ведущей точкой (.5).
  
   - Выявляет недопустимые символы и некорректные последовательности (3 4, 12()), предотвращая ошибки на ранней стадии.
     
- converter_rpn.py:
  
   - Преобразует токенизированное инфиксное выражение в обратную польскую нотацию (RPN).
   
   - Учитывает приоритет операций и различает право- и левостороннюю ассоциативность (^ — правоассоциативная, +/- — левосторонняя).
   
   - Обрабатывает унарные операции через внутренние токены (~ для -, @ для +).
   
   - Проверяет логическую корректность выражений: пустые скобки, число перед скобкой, двойные операторы.
     
- evaluator.py:

   - Вычисляет результат RPN-выражения с помощью стека.
  
   - Поддерживает все бинарные и унарные операции, проверяет корректность типов для целочисленных операций (//, %).

   - Обрабатывает краевые случаи: 0**0 = 1, деление на ноль, большие значения.

   - Поддерживает округление результата до заданного числа знаков после запятой.
     
- calculator.py:
   
   - Основной класс калькулятора, объединяет Tokenizer, RPNConverter и Evaluator.
   
   - Метод solve обеспечивает единый интерфейс: ввод выражения -> токенизация -> преобразование в RPN -> вычисление.

   - Генерирует предупреждения для потенциально опасных выражений (например, очень большие числа).
     
- errors.py:
  
   - Отдельный вид исключений CalculatorError, позволяющий удобно обрабатывать ошибки калькулятора отдельно от стандартных ошибок Python.

   - Упрощает написание тестов и повышение надёжности программы.
     
- main.py:
  
   - Точка входа в программу в интерактивном режиме.

   - Пользователь может выбирать точность округления, видеть результат и предупреждения.

   - Обеспечивает удобный и безопасный интерфейс для работы с калькулятором.

----------------

 Допущения и ограничения:
 --
 1. Выражения должны быть корректно записаны (без двух чисел подряд). Иначе - предупреждение и попытка обработать так, как записано, если не получается, то ошибка.
 
 2. Унарные операции обрабатываются через внутренние токены ~ и @.
 
 3. Пробелы между цифрами и точкой запрещены (2. 5 -> ошибка).
 
 4. Числа с плавающей точкой округляются до 2 знаков по умолчанию (настраиваемо).
 
 5. Числа вида '.5' , '.05' обрабатываются корректно
 
 6. Предупреждения для корректного и эстетичного вывода перенаправлены с потока stderr в stdout и окрашены в контрастный цвет.
 
 7. Для чисел >= 10^3000 предупреждение о большом результате, но вычисления продолжаются. Вывод ограничен 10^6 символами, если больше, то ошибка.
 
 8. При запуске файла main.py можно задать свое округление для результата, по умолчанию - 2 знака после запятой.
 
 9. Для выхода из программы вместо выражения можно ввести q/Q.

----------------

 Основные тест-кейсы:
--
 - Все арифметические операции
 - Скобки и вложенные выражения
 - Унарные операции и комбинации вида '3--2','2*-3'
 - Крайние значения и предупреждения:
    - Слишком большие числа: `10**3000`
    - Деление на ноль: `5/0`
    - Некорректные символы: `2*&1`
- Особые случаи:
    - `0**0` возвращает 1
    - Проверка округления: `1/3` округляется до заданного числа знаков после запятой
    - Ведущие нули и дроби: `003+04`, `(1.5+2.5)*(2/1)`
    - Многоуровневые скобки: `((1+2)*(3+4)/(5-3+1))`
    - Сложные комбинации всех операторов: `2+3*4-5/2**2+1%3//1`
 
 ----------------
 Сценарий работы
 --
 - Склонировать репозиторий
 - Из корневой папки вызвать: python3 src.main
 - Следовать интерфейсу программы
 - Для запуска тестов написать команду: python -m unittest tests/test_M2.py 
